set nonomatch=1

rm *.lst *.ri

echo Removing old max_sizes.f90.
rm max_sizes.f90

echo Creating new params.h.
cat > max_sizes.f90 <<EOF
!------------------------------------------------------------------------
!
! Fortran 90 Code automatically generated by the AutoChem Programme "Roc".
! by David Lary 1993-2004.
!
!------------------------------------------------------------------------
!
MODULE max_sizes
!
! The maximum number of reactions of in a 
! rate of change, jacobian or hessian term.
INTEGER, PARAMETER :: nmaxi =   324
INTEGER, PARAMETER :: nmaxid =   324
INTEGER, PARAMETER :: nmaxij =   212
INTEGER, PARAMETER :: nmaxia =      1
!
END MODULE max_sizes
!
!------------------------------------------------------------------------
EOF

echo Removing old specie.d.
rm specie.d

echo Creating new specie.d.
cat > specie.d <<EOF
specie flag: 1=integrated, 2=not integrated.
1 'O(1D)     ' 'O(^1D)                 '
1 'O(3P)     ' 'O(^3P)                 '
1 'O3        ' 'O_3                    '
1 'N         ' 'N                      '
1 'NO        ' 'NO                     '
1 'NO2       ' 'NO_2                   '
1 'NO3       ' 'NO_3                   '
1 'N2O5      ' 'N_2O_5                 '
1 'HONO      ' 'HONO                   '
1 'HONO2     ' 'HNO_3                  '
1 'HO2NO2    ' 'HO_2NO_2               '
1 'Cl        ' 'Cl                     '
1 'Cl2       ' 'Cl_2                   '
1 'ClO       ' 'ClO                    '
1 'ClOO      ' 'ClOO                   '
1 'OClO      ' 'OClO                   '
1 'Cl2O2     ' 'Cl_2O_2                '
1 'ClNO2     ' 'ClNO_2                 '
1 'ClONO2    ' 'ClONO_2                '
1 'HCl       ' 'HCl                    '
1 'HOCl      ' 'HOCl                   '
1 'MeOCl     ' 'CH_3OCl                '
1 'Br        ' 'Br                     '
1 'Br2       ' 'Br_2                   '
1 'BrO       ' 'BrO                    '
1 'BrONO2    ' 'BrONO_2                '
1 'BrONO     ' 'BrONO                  '
1 'HBr       ' 'HBr                    '
1 'HOBr      ' 'HOBr                   '
1 'BrCl      ' 'BrCl                   '
1 'H2        ' 'H_2                    '
1 'H         ' 'H                      '
1 'OH        ' 'OH                     '
1 'HO2       ' 'HO_2                   '
1 'H2O2      ' 'H_2O_2                 '
1 'CH3       ' 'CH_3                   '
1 'MeO       ' 'CH_3O                  '
1 'MeOO      ' 'CH_3O_2                '
1 'MeOH      ' 'CH_3OH                 '
1 'MeOOH     ' 'CH_3OOH                '
1 'MeONO2    ' 'CH_3ONO_2              '
1 'MeO2NO2   ' 'CH_3O_2NO_2            '
1 'HCO       ' 'HCO                    '
1 'HCHO      ' 'HCHO                   '
1 'CH4       ' 'CH_4                   '
1 'CH3Br     ' 'CH_3Br                 '
1 'CF2Cl2    ' 'CF_2Cl_2               '
1 'CO        ' 'CO                     '
1 'N2O       ' 'N_2O                   '
1 'CO2       ' 'CO_2                   '
1 'H2O       ' 'H_2O                   '
1 'RN10O2    ' 'RN_{10}O_2             '
1 'Me2O      ' 'CH_3OCH_3              '
1 'C2H6      ' 'C_2H_6                 '
1 'EtOO      ' 'C_2H_5O_2              '
1 'C3H8      ' 'C_3H_8                 '
1 'IC3H7O2   ' 'iC_3H_7O_2             '
1 'NC4H10    ' 'nC_4H_{10}             '
1 'RN13O2    ' 'RN_{13}O_2             '
1 'NC5H12    ' 'nC_5H_{12}             '
1 'RN16O2    ' 'RN_{16}O_2             '
1 'NC6H14    ' 'nC_6H_{14}             '
1 'RN19O2    ' 'RN_{19}O_2             '
1 'NC7H16    ' 'nC_7H_{16}             '
1 'RN22O2    ' 'RN_{22}O_2             '
1 'NC8H18    ' 'nC_8H_{18}             '
1 'RN25O2    ' 'RN_{25}O_2             '
1 'NC9H20    ' 'nC_9H_{20}             '
1 'RN28O2    ' 'RN_{28}O_2             '
1 'NC10H22   ' 'nC_{10}H_{22}          '
1 'RN31O2    ' 'RN_{31}O_2             '
1 'NC11H24   ' 'nC_{11}H_{24}          '
1 'RN34O2    ' 'RN_{34}O_2             '
1 'NC12H26   ' 'nC_{12}H_{26}          '
1 'RN37O2    ' 'RN_{37}O_2             '
1 'IC4H10    ' 'iC_4H_{10}             '
1 'RI13O2    ' 'RI_{13}O_2             '
1 'IC5H12    ' 'iC_5H_{12}             '
1 'RI16O2    ' 'RI_{16}O_2             '
1 'NEOP      ' 'neopentane             '
1 'M2PE      ' '2-methylpentane        '
1 'M3PE      ' '3-methylpentane        '
1 'M22C4     ' '2,2-dimethylbutane     '
1 'M23C4     ' '2,3-dimethylbutane     '
1 'M2HEX     ' '2-methylhexane         '
1 'M3HEX     ' '3-methylhexane         '
1 'CHEX      ' 'cyclohexane            '
1 'C2H4      ' 'C_2H_4                 '
1 'HOCH2CH2OO' 'HOCH_2CH_2O_2          '
1 'C3H6      ' 'C_3H_6                 '
1 'RN9O2     ' 'RN_9O_2                '
1 'BUT1ENE   ' 'but1ene                '
1 'RN12O2    ' 'RN_{12}O_2             '
1 'PENT1ENE  ' 'pent1ene               '
1 'RN15O2    ' 'RN_{15}O_2             '
1 'HEX1ENE   ' 'Hex1ene                '
1 'RN18O2    ' 'RN_{18}O_2             '
1 'CBUT2ENE  ' 'c-but2ene              '
1 'TBUT2ENE  ' 't-but2ene              '
1 'CPENT2ENE ' 'c-pent2ene             '
1 'TPENT2ENE ' 't-pent2ene             '
1 'CHEX2ENE  ' 'c-hex2ene              '
1 'THEX2ENE  ' 't-hex2ene              '
1 'MEPROPENE ' 'methylpropene          '
1 'RI12O2    ' 'RI_{12}O_2             '
1 'ME2BUT1ENE' '2-methylbut1ene        '
1 'ME3BUT1ENE' '3-methylbut1ene        '
1 'RI15O2    ' 'RI_{15}O_2             '
1 'ME2BUT2ENE' '2-methylbut2ene        '
1 'NRN6O2    ' 'NRN_6O_2               '
1 'NRN9O2    ' 'NRN_9O_2               '
1 'NRN12O2   ' 'NRN_{12}O_2            '
1 'NRN15O2   ' 'NRN_{15}O_2            '
1 'NRN18O2   ' 'NRN_{18}O_2            '
1 'NRI12O2   ' 'NRI_{12}O_2            '
1 'NRI15O2   ' 'NRI_{15}O_2            '
1 'MeCHO     ' 'CH_3CHO                '
1 'EtCHO     ' 'C_2H_5CHO              '
1 'MeCO2H    ' 'CH_3CO_2H              '
1 'Me2CO     ' 'CH_3COCH_3             '
1 'CARB11    ' 'CARB11                 '
1 'CARB14    ' 'CARB14                 '
1 'C4H6      ' 'C_4H_6                 '
1 'RN11O2    ' 'RN_{11}O_2             '
1 'C5H8      ' 'C_5H_8                 '
1 'RN14O2    ' 'RN_{14}O_2             '
1 'NRN11O2   ' 'NRN_{11}O_2            '
1 'NRN14O2   ' 'NRN_{14}O_2            '
1 'RT28O2    ' 'RT_{28}O_2             '
1 'NRT28O2   ' 'NRT_{28}O_2            '
1 'CARB17    ' 'CARB17                 '
1 'BENZENE   ' 'benzene                '
1 'TOLUENE   ' 'toluene                '
1 'OXYL      ' 'o-xylene               '
1 'RN21O2    ' 'RN_{21}O_2             '
1 'MXYL      ' 'm-xylene               '
1 'PXYL      ' 'p-xylene               '
1 'EBENZ     ' 'ethylbenzene           '
1 'PBENZ     ' 'n-propylbenzene        '
1 'RN24O2    ' 'RN_{24}O_2             '
1 'IPBENZ    ' 'i-propylbenzene        '
1 'RI24O2    ' 'RI_{24}O_2             '
1 'TM123B    ' '1,2,3-trimethylbenzene '
1 'TM124B    ' '1,2,4-trimethylbenzene ' 
1 'TM135B    ' '1,3,5-trimethylbenzene '
1 'OETHTOL   ' 'o-ethyltoluene         '
1 'METHTOL   ' 'm-ethyltoluene         '
1 'PETHTOL   ' 'p-ethyltoluene         '
1 'DIME35EB  ' '3,5dimethylethylbenzene'
1 'RN27O2    ' 'RN_{27}O_2             '
1 'DIET35TOL ' '3,5-diethyltoluene     '
1 'RN30O2    ' 'RN_{30}O_2             '
1 'RE2O2     ' 'RE_2O_2                '
1 'C2H2      ' 'C_2H_2                 '
1 'C3H7CHO   ' 'C_3H_7CHO              '
1 'IPRCHO    ' 'i-butanal              '
1 'C4H9CHO   ' 'C_4H_9CHO              '
1 'MeCO3     ' 'CH_3CO_3               '
1 'CH2OO     ' 'HCOOH                  '
1 'RN8O2     ' 'RN_8O_2                '
1 'MEK       ' '2-butanone             '
1 'MPRK      ' '2-pentanone            '
1 'DIEK      ' 'diethylketone          '
1 'MIPK      ' '3-methylbutanone       '
1 'HEX2ONE   ' 'hex2one                '
1 'HEX3ONE   ' 'hex3one                '
1 'MIBK      ' '4-methylpentan2one     '
1 'MTBK      ' '3,3-dimethylbutan2one  '
1 'CYHEXONE  ' 'cyclohexanone          '
1 'RN17O2    ' 'RN_{17}O_2             '
1 'MeOH      ' 'CH_3OH                 '
1 'EtOH      ' 'C_2H_5OH               '
1 'NPROPOL   ' 'n-propanol             '
1 'IPROPOL   ' 'i-propanol             '
1 'NBUTOL    ' 'n-butanol              '
1 'BUT2OL    ' 'butan2ol               '
1 'IBUTOL    ' 'i-butanol              '
1 'TBUTOL    ' 't-butanol              '
1 'PECOH     ' 'pentan3ol              '
1 'IPEAOH    ' '2-methylbutan1ol       '
1 'ME3BUOL   ' '3-methylbutan1ol       '
1 'IPECOH    ' '2-methylbutan2ol       '
1 'IPEBOH    ' '3-methylbutan2ol       '
1 'CYHEXOL   ' 'cyclohexanol           '
1 'MIBKAOH   ' 'diacetone-alcohol      '
1 'ETHGLY    ' 'ethane-diol            '
1 'PROPGLY   ' '1,2-propane-diol       '
1 'CH3OCHO   ' 'CH_3OCHO               '
1 'DIETETHER ' 'diethylether           '
1 'RE5O2     ' 'RE_5O_2                '
1 'FM1       ' 'FM1                    '
1 'MTBE      ' 'methyl-t-butylether    '
1 'FM2       ' 'FM2                    '
1 'DIIPRETHER' 'di-isopropylether      '
1 'ETBE      ' 'ethyl-tbutylether      '
1 'MO2EOL    ' '2-methoxyethanol       '
1 'EOX2EOL   ' '2-ethoxyethanol        '
1 'PR2OHMOX  ' '2-methoxypropanol      '
1 'BUOX2ETOH ' '2-butoxyethanol        '
1 'BOX2PROL  ' '2-butoxypropanol       '
1 'METHACET  ' 'methylacetate          '
1 'ETHACET   ' 'ethylacetate           '
1 'NPROACET  ' 'n-propylacetate        '
1 'IPROACET  ' 'i-propylacetate        '
1 'NBUTACET  ' 'n-butylacetate         '
1 'SBUTACET  ' '2-butylacetate         '
1 'TBUACET   ' 't-butylacetate         '
1 'PROPACID  ' 'propanoic acid         '
1 'DMM       ' 'dimethoxymethane       '
1 'DMC       ' 'dimethoxycarbonate     '
1 'CH3Cl     ' 'CH_3Cl                 '
1 'CH2Cl2    ' 'CH_2Cl_2               '
1 'CHCl3     ' 'CHCl_3                 '
1 'CH3CCl3   ' 'CH_3CCl_3              '
1 'TCE       ' 'C_2Cl_4                '
1 'TRIClETH  ' 'C_2HCl_3               '
1 'CDIClETH  ' 'c-C_2H_2Cl_2           '
1 'TDIClETH  ' 't-C_2H_2Cl_2           '
1 'EtONO2    ' 'C_2H_5NO_3             '
1 'RN10NO3   ' 'RN_{10}NO_3            '
1 'IC3H7NO3  ' 'iC_3H_7NO_3            '
1 'RN13NO3   ' 'RN_{13}NO_3            '
1 'RN16NO3   ' 'RN_{16}NO_3            '
1 'RN19NO3   ' 'RN_{19}NO_3            '
1 'RN22NO3   ' 'RN_{22}NO_3            '
1 'RN25NO3   ' 'RN_{25}NO_3            '
1 'RN28NO3   ' 'RN_{28}NO_3            '
1 'RN31NO3   ' 'RN_{31}NO_3            '
1 'RN34NO3   ' 'RN_{34}NO_3            '
1 'RN37NO3   ' 'RN_{37}NO_3            '
1 'RI13NO3   ' 'RI_{13}NO_3            '
1 'RI16NO3   ' 'RI_{16}NO_3            '
1 'HOC2H4NO3 ' 'HOC_2H_4NO_3           '
1 'RN9NO3    ' 'RN_9NO_3               '
1 'RN12NO3   ' 'RN_{12}NO_3            '
1 'RN15NO3   ' 'RN_{15}NO_3            '
1 'RN18NO3   ' 'RN_{18}NO_3            '
1 'RN21NO3   ' 'RN_{21}NO_3            '
1 'RN24NO3   ' 'RN_{24}NO_3            '
1 'RN27NO3   ' 'RN_{27}NO_3            '
1 'RN30NO3   ' 'RN_{30}NO_3            '
1 'RI12NO3   ' 'RI_{12}NO_3            '
1 'RI15NO3   ' 'RI_{15}NO_3            '
1 'RI24NO3   ' 'RI_{24}NO_3            '
1 'RE2NO3    ' 'RE_2NO_3               '
1 'RE5NO3    ' 'RE_5NO_3               '
1 'RT28NO3   ' 'RT_{28}NO_3            '
1 'EtOOH     ' 'C_2H_5OOH              '
1 'RN10OOH   ' 'RN_{10}OOH             '
1 'IC3H7OOH  ' 'iC_3H_7OOH             '
1 'RN13OOH   ' 'RN_{13}OOH             '
1 'RN16OOH   ' 'RN_{16}OOH             '
1 'RN19OOH   ' 'RN_{19}OOH             '
1 'RN22OOH   ' 'RN_{22}OOH             '
1 'RN25OOH   ' 'RN_{25}OOH             '
1 'RN28OOH   ' 'RN_{28}OOH             '
1 'RN31OOH   ' 'RN_{31}OOH             '
1 'RN34OOH   ' 'RN_{34}OOH             '
1 'RN37OOH   ' 'RN_{37}OOH             '
1 'RI13OOH   ' 'RI_{13}OOH             '
1 'RI16OOH   ' 'RI_{16}OOH             '
1 'MeCO3H    ' 'CH_3CO_3H              '
1 'RN8OOH    ' 'RN_8OOH                '
1 'RN11OOH   ' 'RN_{11}OOH             '
1 'RN14OOH   ' 'RN_{14}OOH             '
1 'RN17OOH   ' 'RN_{17}OOH             '
1 'HOC2H4OOH ' 'HOC_2H_4OOH            '
1 'RN9OOH    ' 'RN_9OOH                '
1 'RN12OOH   ' 'RN_{12}OOH             '
1 'RN15OOH   ' 'RN_{15}OOH             '
1 'RN18OOH   ' 'RN_{18}OOH             '
1 'RN21OOH   ' 'RN_{21}OOH             '
1 'RN24OOH   ' 'RN_{24}OOH             '
1 'RN27OOH   ' 'RN_{27}OOH             '
1 'RN30OOH   ' 'RN_{30}OOH             '
1 'RI12OOH   ' 'RI_{12}OOH             '
1 'RI15OOH   ' 'RI_{15}OOH             '
1 'RI24OOH   ' 'RI_{24}OOH             '
1 'RE2OOH    ' 'RE_2OOH                '
1 'RE5OOH    ' 'RE_5OOH                '
1 'RT28OOH   ' 'RT_{28}OOH             '
1 'NRN6OOH   ' 'NRN_6OOH               '
1 'NRN9OOH   ' 'NRN_9OOH               '
1 'NRN12OOH  ' 'NRN_{12}OOH            '
1 'NRN15OOH  ' 'NRN_{15}OOH            '
1 'NRN18OOH  ' 'NRN_{18}OOH            '
1 'NRI12OOH  ' 'NRI_{12}OOH            '
1 'NRI15OOH  ' 'NRI_{15}OOH            '
1 'NRN11OOH  ' 'NRN_{11}OOH            '
1 'NRN14OOH  ' 'NRN_{14}OOH            '
1 'NRT28OOH  ' 'NRT_{28}OOH            '
1 'PAN       ' 'PAN                    '
1 'APINENE   ' 'aPinene                '
1 'BPINENE   ' 'bPinene                '
2 'O2        ' 'O_2                    '
2 'N2        ' 'N_2                    '
2 'HClS      ' 'HCl_{(S)}              '
2 'H2OS      ' 'H_2O_{(S)}             '
2 'HONO2S    ' 'HNO_{3(S)}             '
2 'Photon    ' 'h\nu                   '
2 'RO2       ' 'RO_2                   '
2 'm         ' 'M                      '
EOF

echo Removing old total.ctl.
rm total.ctl

echo Creating new total.ctl.
cat > total.ctl <<EOF
9                      ; number of totals.
14 'NOy       '         ; number of species in total and its name.
1 'N         '
1 'NO        '
1 'NO2       '
1 'NO3       '
2 'N2O5      '
1 'HONO      '
1 'HONO2     '
1 'HO2NO2    '
1 'ClNO2     '
1 'ClONO2    '
1 'BrONO2    '
1 'BrONO     '
1 'MeONO2    '
1 'MeO2NO2   '
12 'ClOy      '         ; number of species in total and its name.
1 'Cl        '
2 'Cl2       '
1 'ClO       '
1 'ClOO      '
1 'OClO      '
2 'Cl2O2     '
1 'ClNO2     '
1 'ClONO2    '
1 'HCl       '
1 'HOCl      '
1 'MeOCl     '
1 'BrCl      '
8 'BrOy      '         ; number of species in total and its name.
1 'Br        ' 
2 'Br2       ' 
1 'BrO       ' 
1 'BrONO2    ' 
1 'BrONO     ' 
1 'HBr       ' 
1 'HOBr      ' 
1 'BrCl      ' 
4 'NOx       '          ; number of species in total and its name.
1 'N         '
1 'NO        '
1 'NO2       '
1 'NO3       '                        
3 'ClOx      '         ; number of species in total and its name.
1 'Cl        '
1 'ClO       '
2 'Cl2O2     '                                
2 'BrOx      '         ; number of species in total and its name.
1 'Br        '
1 'BrO       '
3 'HOx       '         ; number of species in total and its name.
1 'H         '
1 'OH        '
1 'HO2       '      
3 'Hy        '         ; number of species in total and its name.
1 'H2        '
1 'H2O       '
2 'CH4       '  
46 'RO2      '         ; number of species in total and its name         
1 'MeOO      '
1 'C2H5O2    '
1 'RN10O2    '
1 'IC3H7O2   '
1 'RN13O2    '
1 'RN16O2    '
1 'RN19O2    '
1 'RN22O2    '
1 'RN25O2    '
1 'RN28O2    '
1 'RN31O2    '
1 'RN34O2    '
1 'RN37O2    '
1 'RI13O2    '
1 'RI16O2    '
1 'CH3CO3    '
1 'RN8O2     '
1 'RN11O2    '
1 'RN14O2    '
1 'RN13O2    '
1 'RN17O2    '
1 'HOCH2CH2O2'
1 'RN9O2     '
1 'RN12O2    '
1 'RN15O2    '
1 'RN18O2    '
1 'RN21O2    '
1 'RN24O2    '
1 'RN27O2    '
1 'RN30O2    '
1 'RI12O2    '
1 'RI15O2    '
1 'RI24O2    '
1 'NRN6O2    '
1 'NRN9O2    '
1 'NRN12O2   '
1 'NRN15O2   '
1 'NRN18O2   '
1 'NRI12O2   '
1 'NRI15O2   '
1 'NRN11O2   '
1 'NRN14O2   '
1 'RE2O2     '
1 'RE5O2     '
1 'RT28O2    '
1 'NRT28O2   '
EOF

echo Creating new pick.ctl.
cat > pick.ctl <<EOF
4               : Reaction select switch.
                0=either reactant(s) or product(s) is a required specie.
                1=both reactant(s) or product(s) is a required specie.
                2=product(s) is a required specie.
                3=reactant(s) is a required specie.
                4=both reactant(s) and all product(s) are a required specie.
1               : Reject reactions with unknown products.
'cri-jpl-bi-sorted.d'  : input bimolecular reaction file.
'react-bi.lst'  : output bimolecular reaction file.
'cri-jpl-tri-sorted.d' : input trimolecular reaction file.
'react-tr.lst'  : output trimolecular reaction file.
'cri-photo.d'   : input photolysis reaction file.
'react-ph.lst'  : output photolysis reaction file.
'v5_ac-het.d'   : input heterogeneous reaction file.
'react-h.lst'   : output heterogeneous reaction file.
'v5_ac-uhet.d'  : input heterogeneous reaction file.
'react-uh.lst'  : output heterogeneous reaction file.
'v5_ac-trans.d' : input bulk-gas phase transfer file.
'react-trans.lst'  : output bulk-gas phase transfer file.
'v5_ac-bulkbi.d'   : input bulk phase bimolecular file.
'react-bulkbi.lst' : output bulk phase bimolecular file.
'v5_ac-cr.d'       : input cosmic ray reaction file.
'react-cr.lst'     : output cosmic ray reaction file.
EOF

echo Creating new roc.ctl.
cat > roc.ctl <<EOF
'react-bi.lst'      : bimolecular reaction file.
'react-tr.lst'      : trimolecular reaction file.
'react-ph.lst'      : photolysis reaction file.
'react-h.lst'       : heterogeneous reaction file.
'react-uh.lst'      : unimolecular heterogeneous reaction file.
'react-trans.lst'   : bulk-gas phase transfer file.
'react-bulkbi.lst'  : bulk phase bimolecular file.
'react-cr.lst'      : cosmic ray reaction file.
0                   : Whether adjoint code is wanted.       
EOF

rm *.o *.mod pick roc
time make -f makefile.pick-mac clean
time make -f makefile.roc-mac clean


time make -f makefile.pick-mac

time ./pick

time make -f makefile.roc-mac

time ./roc

rm *.o *.mod

latex bimolecular
latex trimolecular
latex photolysis
latex heterogeneous
latex cosmicray
latex Derivatives
latex Jacobian
latex Hessian

latex bimolecular
latex trimolecular
latex photolysis
latex heterogeneous
latex cosmicray

echo Making the CRI scheme directories

mkdir Scheme
mkdir Scheme/CRI
cp *.ri react*.lst specie.d *.ctl *.tex Scheme/CRI


